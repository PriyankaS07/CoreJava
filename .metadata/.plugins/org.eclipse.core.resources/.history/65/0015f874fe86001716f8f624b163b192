package com.corejava.jdbc;
 
import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
 
import org.apache.commons.*;
import org.apache.commons.dbcp2.BasicDataSource;
 
public class BasicDataSourceTest {
	public static void main(String[] args) throws Exception {
 
		// Creates a BasicDataSource
		BasicDataSource bs = new BasicDataSource();
 
		// Define Driver Class
		bs.setDriverClassName("oracle.jdbc.driver.OracleDriver");
 
		// Define Server URL
		bs.setUrl("jdbc:mysql://localhost/crunchifydb");
 
		// Define Username
		bs.setUsername("system");
 
		// Define Your Password
		bs.setPassword("1234");
 
		// onnection (session) with a specific database. SQL statements are
		// executed and results are returned within the context of a connection.
		Connection conn = null;
 
		// An object that represents a precompiled SQL statement.
		PreparedStatement stmt = null;
		try {
			conn = bs.getConnection();
			stmt = conn.prepareStatement("select * from department");
 
			// A table of data representing a database result set, which is
			// usually generated by executing a statement that queries the
			// database.
			ResultSet rs = stmt.executeQuery();
			while (rs.next()) {
				System.out.println(rs.getInt("ID") + " - " + rs.getString("NAME"));
			}
		} catch (SQLException e) {
			e.printStackTrace();
		} finally {
			// Close Statement and Connection
			if (stmt != null) {
				stmt.close();
			}
			if (conn != null) {
				conn.close();
			}
		}
	}
}